{"ast":null,"code":"import _toConsumableArray from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _regeneratorRuntime from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _slicedToArray from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useState,useEffect}from'react';import'./App.css';import{useSession,useSupabaseClient,useSessionContext}from'@supabase/auth-helpers-react';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function createGoogleCalendarEvent(_x,_x2,_x3,_x4,_x5,_x6){return _createGoogleCalendarEvent.apply(this,arguments);}function _createGoogleCalendarEvent(){_createGoogleCalendarEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event,calendarId,session,signOut,setRateLimitInfo,setRateLimitHit){var existingGoogleEventId,url,newEvent,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(\"Attempting to create a new Google Calendar event for calendar: \".concat(calendarId),event);// Final duplicate check before creating\n_context.next=3;return checkForDuplicateEvent(event,calendarId,session);case 3:existingGoogleEventId=_context.sent;if(!existingGoogleEventId){_context.next=7;break;}console.log('Duplicate event detected in final check, skipping creation:',existingGoogleEventId);return _context.abrupt(\"return\",existingGoogleEventId);case 7:// Proceed with event creation\nurl=\"https://www.googleapis.com/calendar/v3/calendars/\".concat(calendarId,\"/events\");newEvent={summary:event.title,description:\"\\n      \".concat(event.description,\"\\n      \\nHomeowner Name: \").concat(event.homeownerName,\"\\n      \\nMaterials Needed: \").concat(event.materialsNeeded||'Not specified',\"\\n      \\nIssue Pictures: \").concat(event.issuePictures,\"\\n      \\nCompleted Pictures: \").concat(event.completedPictures,\"\\n    \"),start:{dateTime:event.start.toISOString()},end:{dateTime:event.end.toISOString()},location:\"\".concat(event.streetAddress,\", \").concat(event.city,\", \").concat(event.state,\", \").concat(event.zipCode)};console.log('Event data being sent to Google Calendar API:',newEvent);_context.prev=10;_context.next=13;return fetch(url,{method:'POST',headers:{Authorization:'Bearer '+session.provider_token,'Content-Type':'application/json'},body:JSON.stringify(newEvent)});case 13:response=_context.sent;if(!(response.status===429)){_context.next=18;break;}console.error('Rate limit reached. Stopping further requests.');setRateLimitHit(true);return _context.abrupt(\"return\",null);case 18:_context.next=20;return response.json();case 20:data=_context.sent;if(!response.ok){_context.next=26;break;}console.log('Event successfully created in Google Calendar with ID:',data.id);return _context.abrupt(\"return\",data.id);case 26:console.error('Failed to create event:',data);return _context.abrupt(\"return\",null);case 28:_context.next=34;break;case 30:_context.prev=30;_context.t0=_context[\"catch\"](10);console.error('Error during Google Calendar API request:',_context.t0);return _context.abrupt(\"return\",null);case 34:case\"end\":return _context.stop();}},_callee,null,[[10,30]]);}));return _createGoogleCalendarEvent.apply(this,arguments);}function updateGoogleCalendarEvent(_x7,_x8,_x9,_x10,_x11,_x12,_x13){return _updateGoogleCalendarEvent.apply(this,arguments);}function _updateGoogleCalendarEvent(){_updateGoogleCalendarEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event,calendarId,eventId,session,signOut,setRateLimitInfo,setRateLimitHit){var url,updatedEvent,response,data,remaining,limit,reset;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:console.log(\"Updating Google Calendar event for ID: \".concat(eventId));url=\"https://www.googleapis.com/calendar/v3/calendars/\".concat(calendarId,\"/events/\").concat(eventId);updatedEvent={summary:event.title,description:\"\\n      \".concat(event.description,\"\\n      \\nlocation: \").concat(event.location,\"\\n\\n      \\nHomeowner Name: \").concat(event.homeownerName,\"\\n      \\nMaterials Needed: \").concat(event.materialsNeeded||'Not specified',\"\\n      \\nIssue Pictures: \").concat(event.issuePictures,\"\\n      \\nCompleted Pictures: \").concat(event.completedPictures,\"\\n    \"),start:{dateTime:event.start.toISOString()},end:{dateTime:event.end.toISOString()},location:\"\".concat(event.streetAddress,\", \").concat(event.city,\", \").concat(event.state,\", \").concat(event.zipCode)};_context2.prev=3;_context2.next=6;return fetch(url,{method:'PATCH',headers:{Authorization:'Bearer '+session.provider_token,'Content-Type':'application/json'},body:JSON.stringify(updatedEvent)});case 6:response=_context2.sent;if(!(response.status===429)){_context2.next=11;break;}console.error('Rate limit reached. Stopping further requests.');setRateLimitHit(true);// Stop further requests\nreturn _context2.abrupt(\"return\",null);case 11:_context2.next=13;return response.json();case 13:data=_context2.sent;remaining=response.headers.get('X-RateLimit-Remaining');limit=response.headers.get('X-RateLimit-Limit');reset=response.headers.get('X-RateLimit-Reset');setRateLimitInfo({remaining:remaining,limit:limit,reset:reset});if(!response.ok){_context2.next=23;break;}console.log('Event successfully updated in Google Calendar with ID:',data.id);return _context2.abrupt(\"return\",data.id);case 23:console.error('Failed to update event:',data);if(data.error.code===401){signOut();}return _context2.abrupt(\"return\",null);case 26:_context2.next=32;break;case 28:_context2.prev=28;_context2.t0=_context2[\"catch\"](3);console.error('Error during Google Calendar API request:',_context2.t0);return _context2.abrupt(\"return\",null);case 32:case\"end\":return _context2.stop();}},_callee2,null,[[3,28]]);}));return _updateGoogleCalendarEvent.apply(this,arguments);}function updateAirtableWithGoogleEventIdAndProcessed(_x14,_x15){return _updateAirtableWithGoogleEventIdAndProcessed.apply(this,arguments);}function _updateAirtableWithGoogleEventIdAndProcessed(){_updateAirtableWithGoogleEventIdAndProcessed=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(airtableRecordId,googleEventId){var url,updateData,response,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:console.log(\"Updating Airtable record \".concat(airtableRecordId,\" with Google Event ID: \").concat(googleEventId,\" and marking as processed\"));url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/\".concat(airtableRecordId);updateData={fields:{GoogleEventId:googleEventId,// Update Airtable record with GoogleEventId\nProcessed:true// Mark as processed\n}};_context3.prev=3;_context3.next=6;return fetch(url,{method:'PATCH',headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'},body:JSON.stringify(updateData)});case 6:response=_context3.sent;_context3.next=9;return response.json();case 9:data=_context3.sent;console.log('Airtable update response:',data);if(response.ok){_context3.next=14;break;}console.error('Error updating Airtable with Google Event ID:',data.error);throw new Error(data.error);case 14:console.log('Airtable record successfully updated with Google Event ID and marked as processed:',data);_context3.next=20;break;case 17:_context3.prev=17;_context3.t0=_context3[\"catch\"](3);console.error('Error during Airtable API request:',_context3.t0);case 20:case\"end\":return _context3.stop();}},_callee3,null,[[3,17]]);}));return _updateAirtableWithGoogleEventIdAndProcessed.apply(this,arguments);}function lockAirtableRecord(_x16){return _lockAirtableRecord.apply(this,arguments);}function _lockAirtableRecord(){_lockAirtableRecord=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(airtableRecordId){var url,updateData;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/\".concat(airtableRecordId);updateData={fields:{Processing:true// Mark record as being processed\n}};_context4.prev=2;_context4.next=5;return fetch(url,{method:'PATCH',headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'},body:JSON.stringify(updateData)});case 5:console.log(\"Locked record \".concat(airtableRecordId,\" for processing\"));_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](2);console.error(\"Failed to lock record \".concat(airtableRecordId),_context4.t0);case 11:case\"end\":return _context4.stop();}},_callee4,null,[[2,8]]);}));return _lockAirtableRecord.apply(this,arguments);}function unlockAirtableRecord(_x17){return _unlockAirtableRecord.apply(this,arguments);}function _unlockAirtableRecord(){_unlockAirtableRecord=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(airtableRecordId){var url,response,data;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/\".concat(airtableRecordId);_context5.prev=1;_context5.next=4;return fetch(url,{method:'PATCH',headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'},body:JSON.stringify({fields:{}})// Empty body if you are no longer updating any fields\n});case 4:response=_context5.sent;_context5.next=7;return response.json();case 7:data=_context5.sent;if(response.ok){_context5.next=11;break;}console.error('Error unlocking Airtable record:',data.error||data);throw new Error(data.error||'Unknown error');case 11:console.log(\"Unlocked record \".concat(airtableRecordId,\" after processing\"));_context5.next=17;break;case 14:_context5.prev=14;_context5.t0=_context5[\"catch\"](1);console.error(\"Failed to unlock record \".concat(airtableRecordId),_context5.t0);case 17:case\"end\":return _context5.stop();}},_callee5,null,[[1,14]]);}));return _unlockAirtableRecord.apply(this,arguments);}function updateAirtableWithProcessed(_x18){return _updateAirtableWithProcessed.apply(this,arguments);}function _updateAirtableWithProcessed(){_updateAirtableWithProcessed=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(airtableRecordId){var url,updateData,response,data;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:console.log(\"Marking Airtable record \".concat(airtableRecordId,\" as processed\"));url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/\".concat(airtableRecordId);updateData={fields:{Processed:true// Mark as processed\n}};_context6.prev=3;_context6.next=6;return fetch(url,{method:'PATCH',headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'},body:JSON.stringify(updateData)});case 6:response=_context6.sent;_context6.next=9;return response.json();case 9:data=_context6.sent;console.log('Airtable update response:',data);if(data.error){console.error('Error updating Airtable with processed status:',data.error);}else{console.log('Airtable record successfully marked as processed:',data);}_context6.next=17;break;case 14:_context6.prev=14;_context6.t0=_context6[\"catch\"](3);console.error('Error during Airtable API request:',_context6.t0);case 17:case\"end\":return _context6.stop();}},_callee6,null,[[3,14]]);}));return _updateAirtableWithProcessed.apply(this,arguments);}function fetchAirtableEvents(){return _fetchAirtableEvents.apply(this,arguments);}function _fetchAirtableEvents(){_fetchAirtableEvents=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(){var retryCount,url,response,data,filteredRecords,_args7=arguments;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:retryCount=_args7.length>0&&_args7[0]!==undefined?_args7[0]:0;console.log('Fetching unprocessed events from Airtable...');url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ?filterByFormula=AND(NOT({Processed}), {GoogleEventId} = BLANK())\";// Fetch only unprocessed records without a GoogleEventId\n_context7.prev=3;_context7.next=6;return fetch(url,{headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'}});case 6:response=_context7.sent;if(response.ok){_context7.next=10;break;}console.error(\"Error fetching events from Airtable: HTTP \".concat(response.status));return _context7.abrupt(\"return\",[]);case 10:_context7.next=12;return response.json();case 12:data=_context7.sent;console.log('Raw Airtable data fetched:',data);filteredRecords=data.records.filter(function(record){// Ensure event has a name, start and end dates\nreturn record.fields['Calendar Event Name']&&record.fields['StartDate']&&record.fields['EndDate'];}).map(function(record){return{id:record.id,title:record.fields['Calendar Event Name']||'Untitled Event',start:new Date(record.fields['StartDate']),end:new Date(record.fields['EndDate']),description:record.fields['Billable Reason (If Billable)']||'',branch:record.fields['b']||'Unknown',homeownerName:record.fields['Homeowner Name']||'Unknown',materialsNeeded:record.fields['Materials Needed']||'Not specified',streetAddress:record.fields['Street Address']||'Unknown',city:record.fields['City']||'Unknown',state:record.fields['State']||'Unknown',zipCode:record.fields['Zip Code']||'Unknown',googleEventId:record.fields['GoogleEventId']||null,processed:record.fields['Processed']||false// Track the Processed field\n};});console.log(\"Airtable events to process: \".concat(filteredRecords.length),filteredRecords);return _context7.abrupt(\"return\",filteredRecords);case 19:_context7.prev=19;_context7.t0=_context7[\"catch\"](3);console.error('Error fetching events from Airtable:',_context7.t0);return _context7.abrupt(\"return\",[]);case 23:case\"end\":return _context7.stop();}},_callee7,null,[[3,19]]);}));return _fetchAirtableEvents.apply(this,arguments);}function checkForDuplicateEvent(_x19,_x20,_x21){return _checkForDuplicateEvent.apply(this,arguments);}function _checkForDuplicateEvent(){_checkForDuplicateEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(event,calendarId,session){var url,response,data,existingEvent;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:url=\"https://www.googleapis.com/calendar/v3/calendars/\".concat(calendarId,\"/events?timeMin=\").concat(event.start.toISOString(),\"&timeMax=\").concat(event.end.toISOString());_context8.prev=1;_context8.next=4;return fetch(url,{headers:{Authorization:'Bearer '+session.provider_token}});case 4:response=_context8.sent;_context8.next=7;return response.json();case 7:data=_context8.sent;if(!(data.items&&data.items.length>0)){_context8.next=11;break;}existingEvent=data.items.find(function(existingEvent){return existingEvent.summary===event.title&&// Match title\nexistingEvent.location===\"\".concat(event.streetAddress,\", \").concat(event.city,\", \").concat(event.state,\", \").concat(event.zipCode);}// Match location\n);return _context8.abrupt(\"return\",existingEvent?existingEvent.id:null);case 11:_context8.next=17;break;case 13:_context8.prev=13;_context8.t0=_context8[\"catch\"](1);console.error('Error checking for duplicate events in Google Calendar:',_context8.t0);return _context8.abrupt(\"return\",null);case 17:return _context8.abrupt(\"return\",null);case 18:case\"end\":return _context8.stop();}},_callee8,null,[[1,13]]);}));return _checkForDuplicateEvent.apply(this,arguments);}function sleep(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});}function populateGoogleCalendarWithAirtableRecords(_x22,_x23,_x24,_x25,_x26,_x27,_x28,_x29,_x30){return _populateGoogleCalendarWithAirtableRecords.apply(this,arguments);}function _populateGoogleCalendarWithAirtableRecords(){_populateGoogleCalendarWithAirtableRecords=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(calendarId,calendarName,session,signOut,setAddedRecords,setFailedRecords,setRateLimitInfo,rateLimitHit,setRateLimitHit){var airtableEvents,added,failed,_iterator,_step,event,existingGoogleEventId,updatedGoogleEventId,duplicateGoogleEventId,googleEventId,_updatedGoogleEventId;return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:console.log(\"Starting to populate Google Calendar \\\"\".concat(calendarName,\"\\\" with Airtable records...\"));_context9.next=3;return fetchAirtableEvents();case 3:airtableEvents=_context9.sent;console.log(\"Processing \".concat(airtableEvents.length,\" Airtable events for Google Calendar sync...\"));added=[];failed=[];_iterator=_createForOfIteratorHelper(airtableEvents);_context9.prev=8;_iterator.s();case 10:if((_step=_iterator.n()).done){_context9.next=75;break;}event=_step.value;if(!rateLimitHit){_context9.next=15;break;}console.log(\"Rate limit hit. Stopping further processing.\");return _context9.abrupt(\"break\",75);case 15:console.log(\"Processing event \\\"\".concat(event.title,\"\\\"...\"));if(!(event.branch.toLowerCase()==='unknown'||event.branch.toLowerCase()!==calendarName.toLowerCase())){_context9.next=19;break;}console.log(\"Skipping event \\\"\".concat(event.title,\"\\\" due to branch mismatch.\"));return _context9.abrupt(\"continue\",73);case 19:_context9.next=21;return lockAirtableRecord(event.id);case 21:if(!event.googleEventId){_context9.next=42;break;}console.log(\"Event \\\"\".concat(event.title,\"\\\" already has a GoogleEventId: \").concat(event.googleEventId,\". Verifying in Google Calendar...\"));_context9.next=25;return checkForDuplicateEvent(event,calendarId,session);case 25:existingGoogleEventId=_context9.sent;if(!existingGoogleEventId){_context9.next=39;break;}_context9.next=29;return updateGoogleCalendarEvent(event,calendarId,existingGoogleEventId,session,signOut,setRateLimitInfo,setRateLimitHit);case 29:updatedGoogleEventId=_context9.sent;if(!updatedGoogleEventId){_context9.next=36;break;}added.push(event.title);_context9.next=34;return updateAirtableWithProcessed(event.id);case 34:_context9.next=37;break;case 36:failed.push(event.title);case 37:_context9.next=40;break;case 39:console.log(\"No duplicate found for event \\\"\".concat(event.title,\"\\\". Skipping update.\"));case 40:_context9.next=69;break;case 42:_context9.next=44;return checkForDuplicateEvent(event,calendarId,session);case 44:duplicateGoogleEventId=_context9.sent;if(duplicateGoogleEventId){_context9.next=58;break;}_context9.next=48;return createGoogleCalendarEvent(event,calendarId,session,signOut,setRateLimitInfo,setRateLimitHit);case 48:googleEventId=_context9.sent;if(!googleEventId){_context9.next=55;break;}_context9.next=52;return updateAirtableWithGoogleEventIdAndProcessed(event.id,googleEventId);case 52:added.push(event.title);_context9.next=56;break;case 55:failed.push(event.title);case 56:_context9.next=69;break;case 58:console.log(\"Duplicate event found in Google Calendar for \\\"\".concat(event.title,\"\\\". Updating instead...\"));_context9.next=61;return updateGoogleCalendarEvent(event,calendarId,duplicateGoogleEventId,session,signOut,setRateLimitInfo,setRateLimitHit);case 61:_updatedGoogleEventId=_context9.sent;if(!_updatedGoogleEventId){_context9.next=68;break;}added.push(event.title);_context9.next=66;return updateAirtableWithProcessed(event.id);case 66:_context9.next=69;break;case 68:failed.push(event.title);case 69:_context9.next=71;return unlockAirtableRecord(event.id);case 71:_context9.next=73;return sleep(1000);case 73:_context9.next=10;break;case 75:_context9.next=80;break;case 77:_context9.prev=77;_context9.t0=_context9[\"catch\"](8);_iterator.e(_context9.t0);case 80:_context9.prev=80;_iterator.f();return _context9.finish(80);case 83:setAddedRecords(function(prev){return[].concat(_toConsumableArray(prev),added);});setFailedRecords(function(prev){return[].concat(_toConsumableArray(prev),failed);});console.log(\"Finished populating Google Calendar \\\"\".concat(calendarName,\"\\\" with Airtable records.\"));case 86:case\"end\":return _context9.stop();}},_callee9,null,[[8,77,80,83]]);}));return _populateGoogleCalendarWithAirtableRecords.apply(this,arguments);}function CalendarSection(_ref){var calendarId=_ref.calendarId,calendarName=_ref.calendarName,session=_ref.session,signOut=_ref.signOut,setAddedRecords=_ref.setAddedRecords,setFailedRecords=_ref.setFailedRecords,setRateLimitInfo=_ref.setRateLimitInfo,triggerSync=_ref.triggerSync,setTriggerSync=_ref.setTriggerSync;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),lastSyncTime=_useState2[0],setLastSyncTime=_useState2[1];useEffect(function(){var syncEvents=function syncEvents(){var now=new Date();console.log('Attempting to sync events...');if(lastSyncTime&&now-lastSyncTime<900000){console.log('Sync skipped. Last sync was less than 15 minutes ago.');return;}if(session&&triggerSync){if(!session.provider_token){console.error('No valid session token found. Logging out.');signOut();return;}console.log('Session valid. Initiating sync...');populateGoogleCalendarWithAirtableRecords(calendarId,calendarName,session,signOut,setAddedRecords,setFailedRecords,setRateLimitInfo).then(function(){console.log(\"Finished syncing events to Google Calendar \\\"\".concat(calendarName,\"\\\"\"));setLastSyncTime(new Date());// Update last sync time\nsetTriggerSync(false);// Reset the triggerSync after sync\n}).catch(function(error){return console.error(\"Error syncing Airtable to Google Calendar \\\"\".concat(calendarName,\"\\\":\"),error);});}};if(triggerSync){console.log(\"Manual sync triggered for calendar: \".concat(calendarName));syncEvents();}},[session,signOut,calendarId,calendarName,setAddedRecords,setFailedRecords,setRateLimitInfo,lastSyncTime,triggerSync,setTriggerSync]);return/*#__PURE__*/_jsx(\"div\",{className:\"calendar-item\",children:/*#__PURE__*/_jsx(\"h2\",{children:calendarName})});}function App(){var session=useSession();var supabase=useSupabaseClient();var _useSessionContext=useSessionContext(),isLoading=_useSessionContext.isLoading;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),addedRecords=_useState4[0],setAddedRecords=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),failedRecords=_useState6[0],setFailedRecords=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),triggerSync=_useState8[0],setTriggerSync=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),rateLimitHit=_useState10[0],setRateLimitHit=_useState10[1];// Move this here\nvar calendarInfo=[{id:'c_ebe1fcbce1be361c641591a6c389d4311df7a97961af0020c889686ae059d20a@group.calendar.google.com',name:'Savannah'}].sort(function(a,b){return a.name.localeCompare(b.name);});var handleSyncNow=function handleSyncNow(){console.log('Manual sync button clicked.');setTriggerSync(true);// Trigger manual sync\n};var getGreeting=function getGreeting(){var currentHour=new Date().getHours();if(currentHour<12){return'Good morning';}else if(currentHour<18){return'Good afternoon';}else{return'Good evening';}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Warranty Calendar\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',margin:'0 auto'},children:session?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[getGreeting(),\" \",session.user.email]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSyncNow,children:\"Sync Now\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"calendar-grid\",children:calendarInfo.map(function(calendar){return/*#__PURE__*/_jsx(CalendarSection,{calendarId:calendar.id,calendarName:calendar.name,session:session,signOut:function signOut(){return supabase.auth.signOut();},setAddedRecords:setAddedRecords,setFailedRecords:setFailedRecords,triggerSync:triggerSync,setTriggerSync:setTriggerSync,rateLimitHit:rateLimitHit// Pass rateLimitHit as prop\n,setRateLimitHit:setRateLimitHit// Pass setter as prop\n},calendar.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"records-summary\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Records Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"added-records\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Successfully Added Records:\"}),addedRecords.length>0?/*#__PURE__*/_jsx(\"ul\",{children:addedRecords.map(function(record,index){return/*#__PURE__*/_jsx(\"li\",{children:record},index);})}):/*#__PURE__*/_jsx(\"p\",{children:\"No records added.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"failed-records\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Failed to Add Records:\"}),failedRecords.length>0?/*#__PURE__*/_jsx(\"ul\",{children:failedRecords.map(function(record,index){return/*#__PURE__*/_jsx(\"li\",{children:record},index);})}):/*#__PURE__*/_jsx(\"p\",{children:\"No records failed.\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return supabase.auth.signOut();},children:\"Sign Out\"})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return supabase.auth.signInWithOAuth({provider:'google',options:{scopes:'https://www.googleapis.com/auth/calendar'}});},children:\"Sign In With Google\"})})})]})});}export default App;// Ensure default export","map":{"version":3,"names":["React","useState","useEffect","useSession","useSupabaseClient","useSessionContext","createGoogleCalendarEvent","event","calendarId","session","signOut","setRateLimitInfo","setRateLimitHit","console","log","checkForDuplicateEvent","existingGoogleEventId","url","newEvent","summary","title","description","homeownerName","materialsNeeded","issuePictures","completedPictures","start","dateTime","toISOString","end","location","streetAddress","city","state","zipCode","fetch","method","headers","Authorization","provider_token","body","JSON","stringify","response","status","error","json","data","ok","id","updateGoogleCalendarEvent","eventId","updatedEvent","remaining","get","limit","reset","code","updateAirtableWithGoogleEventIdAndProcessed","airtableRecordId","googleEventId","updateData","fields","GoogleEventId","Processed","Error","lockAirtableRecord","Processing","unlockAirtableRecord","updateAirtableWithProcessed","fetchAirtableEvents","retryCount","filteredRecords","records","filter","record","map","Date","branch","processed","length","items","existingEvent","find","sleep","ms","Promise","resolve","setTimeout","populateGoogleCalendarWithAirtableRecords","calendarName","setAddedRecords","setFailedRecords","rateLimitHit","airtableEvents","added","failed","toLowerCase","updatedGoogleEventId","push","duplicateGoogleEventId","prev","CalendarSection","triggerSync","setTriggerSync","lastSyncTime","setLastSyncTime","syncEvents","now","then","catch","App","supabase","isLoading","addedRecords","failedRecords","calendarInfo","name","sort","a","b","localeCompare","handleSyncNow","getGreeting","currentHour","getHours","width","margin","user","email","calendar","auth","index","signInWithOAuth","provider","options","scopes"],"sources":["/Users/richardmcgirt/Desktop/Warrenty2-/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport { useSession, useSupabaseClient, useSessionContext } from '@supabase/auth-helpers-react';\n\n\n\nasync function createGoogleCalendarEvent(event, calendarId, session, signOut, setRateLimitInfo, setRateLimitHit) {\n  console.log(`Attempting to create a new Google Calendar event for calendar: ${calendarId}`, event);\n\n  // Final duplicate check before creating\n  const existingGoogleEventId = await checkForDuplicateEvent(event, calendarId, session);\n  if (existingGoogleEventId) {\n    console.log('Duplicate event detected in final check, skipping creation:', existingGoogleEventId);\n    return existingGoogleEventId;\n  }\n\n  // Proceed with event creation\n  const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events`;\n\n  const newEvent = {\n    summary: event.title,\n    description: `\n      ${event.description}\n      \\nHomeowner Name: ${event.homeownerName}\n      \\nMaterials Needed: ${event.materialsNeeded || 'Not specified'}\n      \\nIssue Pictures: ${event.issuePictures}\n      \\nCompleted Pictures: ${event.completedPictures}\n    `,\n    start: { dateTime: event.start.toISOString() },\n    end: { dateTime: event.end.toISOString() },\n    location: `${event.streetAddress}, ${event.city}, ${event.state}, ${event.zipCode}`,\n  };\n\n  console.log('Event data being sent to Google Calendar API:', newEvent);\n\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        Authorization: 'Bearer ' + session.provider_token,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(newEvent),\n    });\n\n    if (response.status === 429) {\n      console.error('Rate limit reached. Stopping further requests.');\n      setRateLimitHit(true);\n      return null;\n    }\n\n    const data = await response.json();\n    if (response.ok) {\n      console.log('Event successfully created in Google Calendar with ID:', data.id);\n      return data.id;\n    } else {\n      console.error('Failed to create event:', data);\n      return null;\n    }\n  } catch (error) {\n    console.error('Error during Google Calendar API request:', error);\n    return null;\n  }\n}\n\n\nasync function updateGoogleCalendarEvent(event, calendarId, eventId, session, signOut, setRateLimitInfo, setRateLimitHit) {\n  console.log(`Updating Google Calendar event for ID: ${eventId}`);\n\n  const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events/${eventId}`;\n\n  const updatedEvent = {\n    summary: event.title,\n    description: `\n      ${event.description}\n      \\nlocation: ${event.location}\n\n      \\nHomeowner Name: ${event.homeownerName}\n      \\nMaterials Needed: ${event.materialsNeeded || 'Not specified'}\n      \\nIssue Pictures: ${event.issuePictures}\n      \\nCompleted Pictures: ${event.completedPictures}\n    `,\n    start: { dateTime: event.start.toISOString() },\n    end: { dateTime: event.end.toISOString() },\n    location: `${event.streetAddress}, ${event.city}, ${event.state}, ${event.zipCode}`,\n  };\n\n  try {\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        Authorization: 'Bearer ' + session.provider_token,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updatedEvent),\n    });\n\n    if (response.status === 429) {\n      console.error('Rate limit reached. Stopping further requests.');\n      setRateLimitHit(true); // Stop further requests\n      return null;\n    }\n\n    const data = await response.json();\n    const remaining = response.headers.get('X-RateLimit-Remaining');\n    const limit = response.headers.get('X-RateLimit-Limit');\n    const reset = response.headers.get('X-RateLimit-Reset');\n    setRateLimitInfo({ remaining, limit, reset });\n\n    if (response.ok) {\n      console.log('Event successfully updated in Google Calendar with ID:', data.id);\n      return data.id;\n    } else {\n      console.error('Failed to update event:', data);\n      if (data.error.code === 401) {\n        signOut();\n      }\n      return null;\n    }\n  } catch (error) {\n    console.error('Error during Google Calendar API request:', error);\n    return null;\n  }\n}\n\nasync function updateAirtableWithGoogleEventIdAndProcessed(airtableRecordId, googleEventId) {\n  console.log(`Updating Airtable record ${airtableRecordId} with Google Event ID: ${googleEventId} and marking as processed`);\n  \n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/${airtableRecordId}`;\n  const updateData = {\n    fields: {\n      GoogleEventId: googleEventId, // Update Airtable record with GoogleEventId\n      Processed: true,              // Mark as processed\n    },\n  };\n\n  try {\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updateData),\n    });\n\n    const data = await response.json();\n    console.log('Airtable update response:', data);\n\n    if (!response.ok) {\n      console.error('Error updating Airtable with Google Event ID:', data.error);\n      throw new Error(data.error);\n    }\n\n    console.log('Airtable record successfully updated with Google Event ID and marked as processed:', data);\n  } catch (error) {\n    console.error('Error during Airtable API request:', error);\n  }\n}\n\nasync function lockAirtableRecord(airtableRecordId) {\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/${airtableRecordId}`;\n  const updateData = {\n    fields: {\n      Processing: true, // Mark record as being processed\n    },\n  };\n\n  try {\n    await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updateData),\n    });\n    console.log(`Locked record ${airtableRecordId} for processing`);\n  } catch (error) {\n    console.error(`Failed to lock record ${airtableRecordId}`, error);\n  }\n}\n\nasync function unlockAirtableRecord(airtableRecordId) {\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/${airtableRecordId}`;\n\n  try {\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ fields: {} }), // Empty body if you are no longer updating any fields\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      console.error('Error unlocking Airtable record:', data.error || data);\n      throw new Error(data.error || 'Unknown error');\n    }\n\n    console.log(`Unlocked record ${airtableRecordId} after processing`);\n  } catch (error) {\n    console.error(`Failed to unlock record ${airtableRecordId}`, error);\n  }\n}\n\nasync function updateAirtableWithProcessed(airtableRecordId) {\n  console.log(`Marking Airtable record ${airtableRecordId} as processed`);\n\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/${airtableRecordId}`;\n  const updateData = {\n    fields: {\n      Processed: true,  // Mark as processed\n    },\n  };\n\n  try {\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updateData),\n    });\n\n    const data = await response.json();\n    console.log('Airtable update response:', data);\n\n    if (data.error) {\n      console.error('Error updating Airtable with processed status:', data.error);\n    } else {\n      console.log('Airtable record successfully marked as processed:', data);\n    }\n  } catch (error) {\n    console.error('Error during Airtable API request:', error);\n  }\n}\n\nasync function fetchAirtableEvents(retryCount = 0) {\n  console.log('Fetching unprocessed events from Airtable...');\n\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ?filterByFormula=AND(NOT({Processed}), {GoogleEventId} = BLANK())`; // Fetch only unprocessed records without a GoogleEventId\n\n  try {\n    const response = await fetch(url, {\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      console.error(`Error fetching events from Airtable: HTTP ${response.status}`);\n      return [];\n    }\n\n    const data = await response.json();\n    console.log('Raw Airtable data fetched:', data);\n\n    const filteredRecords = data.records\n      .filter((record) => {\n        // Ensure event has a name, start and end dates\n        return record.fields['Calendar Event Name'] && record.fields['StartDate'] && record.fields['EndDate'];\n      })\n      .map((record) => ({\n        id: record.id,\n        title: record.fields['Calendar Event Name'] || 'Untitled Event',\n        start: new Date(record.fields['StartDate']),\n        end: new Date(record.fields['EndDate']),\n        description: record.fields['Billable Reason (If Billable)'] || '',\n        branch: record.fields['b'] || 'Unknown',\n        homeownerName: record.fields['Homeowner Name'] || 'Unknown',\n        materialsNeeded: record.fields['Materials Needed'] || 'Not specified',\n        streetAddress: record.fields['Street Address'] || 'Unknown',\n        city: record.fields['City'] || 'Unknown',\n        state: record.fields['State'] || 'Unknown',\n        zipCode: record.fields['Zip Code'] || 'Unknown',\n        googleEventId: record.fields['GoogleEventId'] || null,\n        processed: record.fields['Processed'] || false,  // Track the Processed field\n      }));\n\n    console.log(`Airtable events to process: ${filteredRecords.length}`, filteredRecords);\n    return filteredRecords;\n\n  } catch (error) {\n    console.error('Error fetching events from Airtable:', error);\n    return [];\n  }\n}\n\nasync function checkForDuplicateEvent(event, calendarId, session) {\n  const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?timeMin=${event.start.toISOString()}&timeMax=${event.end.toISOString()}`;\n\n  try {\n    const response = await fetch(url, {\n      headers: {\n        Authorization: 'Bearer ' + session.provider_token,\n      },\n    });\n\n    const data = await response.json();\n    \n    if (data.items && data.items.length > 0) {\n      const existingEvent = data.items.find(\n        (existingEvent) =>\n          existingEvent.summary === event.title && // Match title\n          existingEvent.location === `${event.streetAddress}, ${event.city}, ${event.state}, ${event.zipCode}` // Match location\n      );\n\n      return existingEvent ? existingEvent.id : null; // Return the Google Event ID if a match is found\n    }\n  } catch (error) {\n    console.error('Error checking for duplicate events in Google Calendar:', error);\n    return null;\n  }\n\n  return null;\n}\n\nfunction sleep(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nasync function populateGoogleCalendarWithAirtableRecords(\n  calendarId,\n  calendarName,\n  session,\n  signOut,\n  setAddedRecords,\n  setFailedRecords,\n  setRateLimitInfo,\n  rateLimitHit,\n  setRateLimitHit\n) {\n  console.log(`Starting to populate Google Calendar \"${calendarName}\" with Airtable records...`);\n\n  const airtableEvents = await fetchAirtableEvents();\n  console.log(`Processing ${airtableEvents.length} Airtable events for Google Calendar sync...`);\n\n  const added = [];\n  const failed = [];\n\n  for (const event of airtableEvents) {\n    if (rateLimitHit) {\n      console.log(`Rate limit hit. Stopping further processing.`);\n      break;\n    }\n\n    console.log(`Processing event \"${event.title}\"...`);\n\n    if (event.branch.toLowerCase() === 'unknown' || event.branch.toLowerCase() !== calendarName.toLowerCase()) {\n      console.log(`Skipping event \"${event.title}\" due to branch mismatch.`);\n      continue;\n    }\n\n    // Lock the record to prevent it from being processed by another process\n    await lockAirtableRecord(event.id);\n\n    // Check if the event already has a GoogleEventId\n    if (event.googleEventId) {\n      console.log(`Event \"${event.title}\" already has a GoogleEventId: ${event.googleEventId}. Verifying in Google Calendar...`);\n\n      const existingGoogleEventId = await checkForDuplicateEvent(event, calendarId, session);\n\n      if (existingGoogleEventId) {\n        const updatedGoogleEventId = await updateGoogleCalendarEvent(\n          event,\n          calendarId,\n          existingGoogleEventId,\n          session,\n          signOut,\n          setRateLimitInfo,\n          setRateLimitHit\n        );\n\n        if (updatedGoogleEventId) {\n          added.push(event.title);\n          await updateAirtableWithProcessed(event.id); // Mark as processed\n        } else {\n          failed.push(event.title);\n        }\n      } else {\n        console.log(`No duplicate found for event \"${event.title}\". Skipping update.`);\n      }\n    } else {\n      // Check Google Calendar for an existing event to avoid duplicates\n      const duplicateGoogleEventId = await checkForDuplicateEvent(event, calendarId, session);\n\n      if (!duplicateGoogleEventId) {\n        const googleEventId = await createGoogleCalendarEvent(\n          event,\n          calendarId,\n          session,\n          signOut,\n          setRateLimitInfo,\n          setRateLimitHit\n        );\n\n        if (googleEventId) {\n          await updateAirtableWithGoogleEventIdAndProcessed(event.id, googleEventId);\n          added.push(event.title);\n        } else {\n          failed.push(event.title);\n        }\n      } else {\n        console.log(`Duplicate event found in Google Calendar for \"${event.title}\". Updating instead...`);\n        const updatedGoogleEventId = await updateGoogleCalendarEvent(\n          event,\n          calendarId,\n          duplicateGoogleEventId,\n          session,\n          signOut,\n          setRateLimitInfo,\n          setRateLimitHit\n        );\n\n        if (updatedGoogleEventId) {\n          added.push(event.title);\n          await updateAirtableWithProcessed(event.id); // Mark as processed\n        } else {\n          failed.push(event.title);\n        }\n      }\n    }\n\n    await unlockAirtableRecord(event.id); // Unlock the record after processing\n    await sleep(1000); // Adding delay between requests\n  }\n\n  setAddedRecords((prev) => [...prev, ...added]);\n  setFailedRecords((prev) => [...prev, ...failed]);\n\n  console.log(`Finished populating Google Calendar \"${calendarName}\" with Airtable records.`);\n}\n\nfunction CalendarSection({\n  calendarId,\n  calendarName,\n  session,\n  signOut,\n  setAddedRecords,\n  setFailedRecords,\n  setRateLimitInfo,\n  triggerSync,\n  setTriggerSync\n}) {\n  const [lastSyncTime, setLastSyncTime] = useState(null);\n\n  useEffect(() => {\n    const syncEvents = () => {\n      const now = new Date();\n      console.log('Attempting to sync events...');\n\n      if (lastSyncTime && now - lastSyncTime < 900000) {\n        console.log('Sync skipped. Last sync was less than 15 minutes ago.');\n        return;\n      }\n\n      if (session && triggerSync) {\n        if (!session.provider_token) {\n          console.error('No valid session token found. Logging out.');\n          signOut();\n          return;\n        }\n\n        console.log('Session valid. Initiating sync...');\n        populateGoogleCalendarWithAirtableRecords(\n          calendarId,\n          calendarName,\n          session,\n          signOut,\n          setAddedRecords,\n          setFailedRecords,\n          setRateLimitInfo\n        )\n          .then(() => {\n            console.log(`Finished syncing events to Google Calendar \"${calendarName}\"`);\n            setLastSyncTime(new Date()); // Update last sync time\n            setTriggerSync(false); // Reset the triggerSync after sync\n          })\n          .catch((error) =>\n            console.error(`Error syncing Airtable to Google Calendar \"${calendarName}\":`, error)\n          );\n      }\n    };\n\n    if (triggerSync) {\n      console.log(`Manual sync triggered for calendar: ${calendarName}`);\n      syncEvents();\n    }\n  }, [session, signOut, calendarId, calendarName, setAddedRecords, setFailedRecords, setRateLimitInfo, lastSyncTime, triggerSync, setTriggerSync]);\n\n  return (\n    <div className=\"calendar-item\">\n      <h2>{calendarName}</h2>\n    </div>\n  );\n}\n\nfunction App() {\n  const session = useSession();\n  const supabase = useSupabaseClient();\n  const { isLoading } = useSessionContext();\n\n  const [addedRecords, setAddedRecords] = useState([]);\n  const [failedRecords, setFailedRecords] = useState([]);\n  const [triggerSync, setTriggerSync] = useState(false);\n  const [rateLimitHit, setRateLimitHit] = useState(false); // Move this here\n\n  const calendarInfo = [\n    { id: 'c_ebe1fcbce1be361c641591a6c389d4311df7a97961af0020c889686ae059d20a@group.calendar.google.com', name: 'Savannah' }\n  ].sort((a, b) => a.name.localeCompare(b.name));\n\n  const handleSyncNow = () => {\n    console.log('Manual sync button clicked.');\n    setTriggerSync(true); // Trigger manual sync\n  };\n\n  const getGreeting = () => {\n    const currentHour = new Date().getHours();\n    if (currentHour < 12) {\n      return 'Good morning';\n    } else if (currentHour < 18) {\n      return 'Good afternoon';\n    } else {\n      return 'Good evening';\n    }\n  };\n\n  if (isLoading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"container\">\n        <h1>Warranty Calendar</h1>\n        <div style={{ width: '100%', margin: '0 auto' }}>\n          {session ? (\n            <>\n              <h2>{getGreeting()} {session.user.email}</h2>\n              <hr />\n              <button onClick={handleSyncNow}>Sync Now</button> {/* Manual Sync Button */}\n              <div className=\"calendar-grid\">\n                {calendarInfo.map((calendar) => (\n                  <CalendarSection\n                  key={calendar.id}\n                  calendarId={calendar.id}\n                  calendarName={calendar.name}\n                  session={session}\n                  signOut={() => supabase.auth.signOut()}\n                  setAddedRecords={setAddedRecords}\n                  setFailedRecords={setFailedRecords}\n                  triggerSync={triggerSync}\n                  setTriggerSync={setTriggerSync}\n                  rateLimitHit={rateLimitHit} // Pass rateLimitHit as prop\n                  setRateLimitHit={setRateLimitHit} // Pass setter as prop\n                />\n                \n                ))}\n              </div>\n              <div className=\"records-summary\">\n                <h3>Records Summary</h3>\n                <div className=\"summary-container\">\n                  <div className=\"added-records\">\n                    <h4>Successfully Added Records:</h4>\n                    {addedRecords.length > 0 ? (\n                      <ul>\n                        {addedRecords.map((record, index) => (\n                          <li key={index}>{record}</li>\n                        ))}\n                      </ul>\n                    ) : (\n                      <p>No records added.</p>\n                    )}\n                  </div>\n                  <div className=\"failed-records\">\n                    <h4>Failed to Add Records:</h4>\n                    {failedRecords.length > 0 ? (\n                      <ul>\n                        {failedRecords.map((record, index) => (\n                          <li key={index}>{record}</li>\n                        ))}\n                      </ul>\n                    ) : (\n                      <p>No records failed.</p>\n                    )}\n                  </div>\n                </div>\n              </div>\n             \n              <button onClick={() => supabase.auth.signOut()}>Sign Out</button>\n            </>\n          ) : (\n            <>\n              <button onClick={() => supabase.auth.signInWithOAuth({ provider: 'google', options: { scopes: 'https://www.googleapis.com/auth/calendar' } })}>\n                Sign In With Google\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App; // Ensure default export\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}