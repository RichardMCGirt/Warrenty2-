{"ast":null,"code":"import _toConsumableArray from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _regeneratorRuntime from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _slicedToArray from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/Users/richardmcgirt/Desktop/Warrenty2-/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useState,useEffect}from'react';import'./App.css';import{useSession,useSupabaseClient,useSessionContext}from'@supabase/auth-helpers-react';// Helper to debounce API calls\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function debounce(fn,delay){var timeoutId;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}if(timeoutId){clearTimeout(timeoutId);}timeoutId=setTimeout(function(){fn.apply(void 0,args);},delay);};}function createGoogleCalendarEvent(_x,_x2,_x3,_x4,_x5){return _createGoogleCalendarEvent.apply(this,arguments);}function _createGoogleCalendarEvent(){_createGoogleCalendarEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event,calendarId,session,signOut,setRateLimitInfo){var url,newEvent,response,data,remaining,limit,reset;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(\"Attempting to create a new Google Calendar event for calendar: \".concat(calendarId),event);if(session.provider_token){_context.next=5;break;}console.error('No valid session token available. Logging out.');signOut();return _context.abrupt(\"return\",null);case 5:url=\"https://www.googleapis.com/calendar/v3/calendars/\".concat(calendarId,\"/events\");newEvent={summary:event.title,description:\"\\n      \".concat(event.description,\"\\n      \\nHomeowner Name: \").concat(event.homeownerName,\"\\n      \\nMaterials Needed: \").concat(event.materialsNeeded||'Not specified',\"\\n      \\nIssue Pictures: \").concat(event.issuePictures,\"\\n      \\nCompleted Pictures: \").concat(event.completedPictures,\"\\n    \"),start:{dateTime:event.start.toISOString()},end:{dateTime:event.end.toISOString()},location:\"\".concat(event.streetAddress,\", \").concat(event.city,\", \").concat(event.state,\", \").concat(event.zipCode)};console.log('Event data being sent to Google Calendar API:',newEvent);_context.prev=8;_context.next=11;return fetch(url,{method:'POST',headers:{Authorization:'Bearer '+session.provider_token,'Content-Type':'application/json'},body:JSON.stringify(newEvent)});case 11:response=_context.sent;_context.next=14;return response.json();case 14:data=_context.sent;console.log('Google Calendar API response:',data);remaining=response.headers.get('X-RateLimit-Remaining');limit=response.headers.get('X-RateLimit-Limit');reset=response.headers.get('X-RateLimit-Reset');setRateLimitInfo({remaining:remaining,limit:limit,reset:reset});if(!response.ok){_context.next=25;break;}console.log('Event successfully created in Google Calendar with ID:',data.id);return _context.abrupt(\"return\",data.id);case 25:console.error('Failed to create event:',data);if(data.error.code===401){console.error('Unauthorized - Logging out');signOut();}return _context.abrupt(\"return\",null);case 28:_context.next=34;break;case 30:_context.prev=30;_context.t0=_context[\"catch\"](8);console.error('Error during Google Calendar API request:',_context.t0);return _context.abrupt(\"return\",null);case 34:case\"end\":return _context.stop();}},_callee,null,[[8,30]]);}));return _createGoogleCalendarEvent.apply(this,arguments);}function updateGoogleCalendarEvent(_x6,_x7,_x8,_x9,_x10,_x11){return _updateGoogleCalendarEvent.apply(this,arguments);}function _updateGoogleCalendarEvent(){_updateGoogleCalendarEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event,calendarId,eventId,session,signOut,setRateLimitInfo){var url,updatedEvent,response,data,remaining,limit,reset;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:console.log(\"Updating Google Calendar event for ID: \".concat(eventId));url=\"https://www.googleapis.com/calendar/v3/calendars/\".concat(calendarId,\"/events/\").concat(eventId);updatedEvent={summary:event.title,description:\"\\n      \".concat(event.description,\"\\n      \\nHomeowner Name: \").concat(event.homeownerName,\"\\n      \\nMaterials Needed: \").concat(event.materialsNeeded||'Not specified',\"\\n      \\nIssue Pictures: \").concat(event.issuePictures,\"\\n      \\nCompleted Pictures: \").concat(event.completedPictures,\"\\n    \"),start:{dateTime:event.start.toISOString()},end:{dateTime:event.end.toISOString()},location:\"\".concat(event.streetAddress,\", \").concat(event.city,\", \").concat(event.state,\", \").concat(event.zipCode)};_context2.prev=3;_context2.next=6;return fetch(url,{method:'PATCH',headers:{Authorization:'Bearer '+session.provider_token,'Content-Type':'application/json'},body:JSON.stringify(updatedEvent)});case 6:response=_context2.sent;_context2.next=9;return response.json();case 9:data=_context2.sent;remaining=response.headers.get('X-RateLimit-Remaining');limit=response.headers.get('X-RateLimit-Limit');reset=response.headers.get('X-RateLimit-Reset');setRateLimitInfo({remaining:remaining,limit:limit,reset:reset});if(!response.ok){_context2.next=19;break;}console.log('Event successfully updated in Google Calendar with ID:',data.id);return _context2.abrupt(\"return\",data.id);case 19:console.error('Failed to update event:',data);if(data.error.code===401){signOut();}return _context2.abrupt(\"return\",null);case 22:_context2.next=28;break;case 24:_context2.prev=24;_context2.t0=_context2[\"catch\"](3);console.error('Error during Google Calendar API request:',_context2.t0);return _context2.abrupt(\"return\",null);case 28:case\"end\":return _context2.stop();}},_callee2,null,[[3,24]]);}));return _updateGoogleCalendarEvent.apply(this,arguments);}function updateAirtableWithGoogleEventId(_x12,_x13){return _updateAirtableWithGoogleEventId.apply(this,arguments);}function _updateAirtableWithGoogleEventId(){_updateAirtableWithGoogleEventId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(airtableRecordId,googleEventId){var url,updateData,response,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:console.log(\"Updating Airtable record \".concat(airtableRecordId,\" with Google Event ID: \").concat(googleEventId));url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/\".concat(airtableRecordId);updateData={fields:{GoogleEventId:googleEventId}};_context3.prev=3;_context3.next=6;return fetch(url,{method:'PATCH',headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'},body:JSON.stringify(updateData)});case 6:response=_context3.sent;_context3.next=9;return response.json();case 9:data=_context3.sent;console.log('Airtable update response:',data);if(data.error){console.error('Error updating Airtable with Google Event ID:',data.error);}else{console.log('Airtable record successfully updated with Google Event ID:',data);}_context3.next=17;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](3);console.error('Error during Airtable API request:',_context3.t0);case 17:case\"end\":return _context3.stop();}},_callee3,null,[[3,14]]);}));return _updateAirtableWithGoogleEventId.apply(this,arguments);}function fetchAirtableEvents(){return _fetchAirtableEvents.apply(this,arguments);}function _fetchAirtableEvents(){_fetchAirtableEvents=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var retryCount,url,maxRetries,response,retryAfter,waitTime,data,filteredRecords,_args4=arguments;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:retryCount=_args4.length>0&&_args4[0]!==undefined?_args4[0]:0;console.log('Fetching events from Airtable...');url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ\";maxRetries=1;_context4.prev=4;_context4.next=7;return fetch(url,{headers:{'Authorization':'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'}});case 7:response=_context4.sent;if(response.ok){_context4.next=23;break;}if(!(response.status===429)){_context4.next=22;break;}retryAfter=response.headers.get('Retry-After');waitTime=retryAfter?parseInt(retryAfter)*1000:Math.pow(2,retryCount)*1000;console.warn(\"Rate limit hit. Retrying after \".concat(waitTime,\"ms...\"));if(!(retryCount<maxRetries)){_context4.next=19;break;}_context4.next=16;return new Promise(function(resolve){return setTimeout(resolve,waitTime);});case 16:return _context4.abrupt(\"return\",fetchAirtableEvents(retryCount+1));case 19:throw new Error('Max retries exceeded');case 20:_context4.next=23;break;case 22:throw new Error(\"HTTP error! status: \".concat(response.status));case 23:_context4.next=25;return response.json();case 25:data=_context4.sent;console.log('Raw Airtable data fetched:',data);filteredRecords=data.records.filter(function(record){var hasEventName=!!record.fields['Calendar Event Name'];var hasStartDate=!!record.fields['StartDate'];var hasEndDate=!!record.fields['EndDate'];if(!hasEventName||!hasStartDate||!hasEndDate){console.warn(\"Record filtered out: \".concat(record.id));return false;}return true;}).map(function(record){return{id:record.id,title:record.fields['Calendar Event Name']||'Untitled Event',start:new Date(record.fields['StartDate']),end:new Date(record.fields['EndDate']),description:record.fields['Billable Reason (If Billable)']||'',branch:record.fields['b']||'Unknown',homeownerName:record.fields['Homeowner Name']||'Unknown',materialsNeeded:record.fields['Materials Needed']||'Not specified',streetAddress:record.fields['Street Address']||'Unknown',city:record.fields['City']||'Unknown',state:record.fields['State']||'Unknown',zipCode:record.fields['Zip Code']||'Unknown',issuePictures:record.fields['Picture(s) of Issue']?record.fields['Picture(s) of Issue'].map(function(pic){return pic.url;}).join(', '):'No pictures provided',completedPictures:record.fields['Completed Pictures']?record.fields['Completed Pictures'].map(function(pic){return pic.url;}).join(', '):'No pictures provided',googleEventId:record.fields['GoogleEventId']||null};});console.log(\"Airtable events to process: \".concat(filteredRecords.length),filteredRecords);return _context4.abrupt(\"return\",filteredRecords);case 32:_context4.prev=32;_context4.t0=_context4[\"catch\"](4);console.error('Error fetching events from Airtable:',_context4.t0);if(!(retryCount<maxRetries)){_context4.next=40;break;}console.log(\"Retrying fetch attempt \".concat(retryCount+1,\" of \").concat(maxRetries,\"...\"));return _context4.abrupt(\"return\",fetchAirtableEvents(retryCount+1));case 40:throw _context4.t0;case 41:case\"end\":return _context4.stop();}},_callee4,null,[[4,32]]);}));return _fetchAirtableEvents.apply(this,arguments);}function checkForDuplicateEvent(_x14,_x15,_x16){return _checkForDuplicateEvent.apply(this,arguments);}function _checkForDuplicateEvent(){_checkForDuplicateEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(event,calendarId,session){var url,response,data,existingEvent;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:url=\"https://www.googleapis.com/calendar/v3/calendars/\".concat(calendarId,\"/events?timeMin=\").concat(event.start.toISOString(),\"&timeMax=\").concat(event.end.toISOString());_context5.prev=1;_context5.next=4;return fetch(url,{headers:{Authorization:'Bearer '+session.provider_token}});case 4:response=_context5.sent;_context5.next=7;return response.json();case 7:data=_context5.sent;if(!data.items){_context5.next=11;break;}existingEvent=data.items.find(function(existingEvent){return existingEvent.summary===event.title&&existingEvent.location===\"\".concat(event.streetAddress,\", \").concat(event.city,\", \").concat(event.state,\", \").concat(event.zipCode);});return _context5.abrupt(\"return\",existingEvent?existingEvent.id:null);case 11:_context5.next=17;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](1);console.error('Error checking for duplicate events in Google Calendar:',_context5.t0);return _context5.abrupt(\"return\",null);case 17:case\"end\":return _context5.stop();}},_callee5,null,[[1,13]]);}));return _checkForDuplicateEvent.apply(this,arguments);}function sleep(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});}function checkIfAirtableRecordExists(_x17,_x18,_x19){return _checkIfAirtableRecordExists.apply(this,arguments);}function _checkIfAirtableRecordExists(){_checkIfAirtableRecordExists=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(eventTitle,eventStart,eventEnd){var url,response,data;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:url=\"https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ?filterByFormula=AND({Calendar Event Name}=\\\"\".concat(eventTitle,\"\\\", {StartDate}=\\\"\").concat(eventStart.toISOString(),\"\\\", {EndDate}=\\\"\").concat(eventEnd.toISOString(),\"\\\")\");_context6.prev=1;_context6.next=4;return fetch(url,{headers:{Authorization:'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238','Content-Type':'application/json'}});case 4:response=_context6.sent;_context6.next=7;return response.json();case 7:data=_context6.sent;return _context6.abrupt(\"return\",data.records.length>0?data.records[0]:null);case 11:_context6.prev=11;_context6.t0=_context6[\"catch\"](1);console.error('Error checking Airtable for existing record:',_context6.t0);return _context6.abrupt(\"return\",null);case 15:case\"end\":return _context6.stop();}},_callee6,null,[[1,11]]);}));return _checkIfAirtableRecordExists.apply(this,arguments);}function populateGoogleCalendarWithAirtableRecords(_x20,_x21,_x22,_x23,_x24,_x25,_x26){return _populateGoogleCalendarWithAirtableRecords.apply(this,arguments);}function _populateGoogleCalendarWithAirtableRecords(){_populateGoogleCalendarWithAirtableRecords=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(calendarId,calendarName,session,signOut,setAddedRecords,setFailedRecords,setRateLimitInfo){var airtableEvents,added,failed,_iterator,_step,event,existingAirtableRecord,existingGoogleEventId,updatedGoogleEventId,googleEventId;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:console.log(\"Starting to populate Google Calendar \\\"\".concat(calendarName,\"\\\" with Airtable records...\"));_context7.next=3;return fetchAirtableEvents();case 3:airtableEvents=_context7.sent;console.log(\"Processing \".concat(airtableEvents.length,\" Airtable events for Google Calendar sync...\"));added=[];failed=[];_iterator=_createForOfIteratorHelper(airtableEvents);_context7.prev=8;_iterator.s();case 10:if((_step=_iterator.n()).done){_context7.next=54;break;}event=_step.value;console.log(\"Processing event \\\"\".concat(event.title,\"\\\"...\"));if(!(event.branch.toLowerCase()==='unknown'||event.branch.toLowerCase()!==calendarName.toLowerCase())){_context7.next=16;break;}console.log(\"Skipping event \\\"\".concat(event.title,\"\\\" due to branch \\\"\").concat(event.branch,\"\\\" not matching \\\"\").concat(calendarName,\"\\\" or being \\\"Unknown\\\"\"));return _context7.abrupt(\"continue\",52);case 16:_context7.next=18;return checkIfAirtableRecordExists(event.title,event.start,event.end);case 18:existingAirtableRecord=_context7.sent;if(!existingAirtableRecord){_context7.next=23;break;}console.log(\"Event \\\"\".concat(event.title,\"\\\" already exists in Airtable. Skipping creation.\"));failed.push(event.title);return _context7.abrupt(\"continue\",52);case 23:_context7.next=25;return checkForDuplicateEvent(event,calendarId,session);case 25:existingGoogleEventId=_context7.sent;if(!existingGoogleEventId){_context7.next=40;break;}console.log(\"Duplicate event found: \\\"\".concat(event.title,\"\\\". Updating...\"));_context7.next=30;return updateGoogleCalendarEvent(event,calendarId,existingGoogleEventId,session,signOut,setRateLimitInfo);case 30:updatedGoogleEventId=_context7.sent;if(!updatedGoogleEventId){_context7.next=37;break;}_context7.next=34;return updateAirtableWithGoogleEventId(event.id,updatedGoogleEventId);case 34:added.push(event.title);_context7.next=38;break;case 37:failed.push(event.title);case 38:_context7.next=50;break;case 40:_context7.next=42;return createGoogleCalendarEvent(event,calendarId,session,signOut,setRateLimitInfo);case 42:googleEventId=_context7.sent;if(!googleEventId){_context7.next=49;break;}_context7.next=46;return updateAirtableWithGoogleEventId(event.id,googleEventId);case 46:added.push(event.title);_context7.next=50;break;case 49:failed.push(event.title);case 50:_context7.next=52;return sleep(1000);case 52:_context7.next=10;break;case 54:_context7.next=59;break;case 56:_context7.prev=56;_context7.t0=_context7[\"catch\"](8);_iterator.e(_context7.t0);case 59:_context7.prev=59;_iterator.f();return _context7.finish(59);case 62:setAddedRecords(function(prev){return[].concat(_toConsumableArray(prev),added);});setFailedRecords(function(prev){return[].concat(_toConsumableArray(prev),failed);});console.log(\"Finished populating Google Calendar \\\"\".concat(calendarName,\"\\\" with Airtable records.\"));case 65:case\"end\":return _context7.stop();}},_callee7,null,[[8,56,59,62]]);}));return _populateGoogleCalendarWithAirtableRecords.apply(this,arguments);}function CalendarSection(_ref){var calendarId=_ref.calendarId,calendarName=_ref.calendarName,session=_ref.session,signOut=_ref.signOut,setAddedRecords=_ref.setAddedRecords,setFailedRecords=_ref.setFailedRecords,setRateLimitInfo=_ref.setRateLimitInfo,triggerSync=_ref.triggerSync,setTriggerSync=_ref.setTriggerSync;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),lastSyncTime=_useState2[0],setLastSyncTime=_useState2[1];useEffect(function(){var syncEvents=function syncEvents(){var now=new Date();console.log('Attempting to sync events...');if(lastSyncTime&&now-lastSyncTime<900000){console.log('Sync skipped. Last sync was less than 15 minutes ago.');return;}if(session&&triggerSync){if(!session.provider_token){console.error('No valid session token found. Logging out.');signOut();return;}console.log('Session valid. Initiating sync...');populateGoogleCalendarWithAirtableRecords(calendarId,calendarName,session,signOut,setAddedRecords,setFailedRecords,setRateLimitInfo).then(function(){console.log(\"Finished syncing events to Google Calendar \\\"\".concat(calendarName,\"\\\"\"));setLastSyncTime(new Date());// Update last sync time\nsetTriggerSync(false);// Reset the triggerSync after sync\n}).catch(function(error){return console.error(\"Error syncing Airtable to Google Calendar \\\"\".concat(calendarName,\"\\\":\"),error);});}};if(triggerSync){console.log(\"Manual sync triggered for calendar: \".concat(calendarName));syncEvents();}},[session,signOut,calendarId,calendarName,setAddedRecords,setFailedRecords,setRateLimitInfo,lastSyncTime,triggerSync,setTriggerSync]);return/*#__PURE__*/_jsx(\"div\",{className:\"calendar-item\",children:/*#__PURE__*/_jsx(\"h2\",{children:calendarName})});}function App(){var session=useSession();var supabase=useSupabaseClient();var _useSessionContext=useSessionContext(),isLoading=_useSessionContext.isLoading;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),addedRecords=_useState4[0],setAddedRecords=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),failedRecords=_useState6[0],setFailedRecords=_useState6[1];var _useState7=useState({remaining:null,limit:null,reset:null}),_useState8=_slicedToArray(_useState7,2),rateLimitInfo=_useState8[0],setRateLimitInfo=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),triggerSync=_useState10[0],setTriggerSync=_useState10[1];var calendarInfo=[{id:'c_ebe1fcbce1be361c641591a6c389d4311df7a97961af0020c889686ae059d20a@group.calendar.google.com',name:'Savannah'}].sort(function(a,b){return a.name.localeCompare(b.name);});var handleSyncNow=function handleSyncNow(){console.log('Manual sync button clicked.');setTriggerSync(true);// Trigger manual sync\n};var getGreeting=function getGreeting(){var currentHour=new Date().getHours();if(currentHour<12){return'Good morning';}else if(currentHour<18){return'Good afternoon';}else{return'Good evening';}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Warranty Calendar\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',margin:'0 auto'},children:session?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[getGreeting(),\" \",session.user.email]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSyncNow,children:\"Sync Now\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"calendar-grid\",children:calendarInfo.map(function(calendar){return/*#__PURE__*/_jsx(CalendarSection,{calendarId:calendar.id,calendarName:calendar.name,session:session,signOut:function signOut(){return supabase.auth.signOut();},setAddedRecords:setAddedRecords,setFailedRecords:setFailedRecords,setRateLimitInfo:setRateLimitInfo,triggerSync:triggerSync,setTriggerSync:setTriggerSync},calendar.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"records-summary\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Records Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"added-records\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Successfully Added Records:\"}),addedRecords.length>0?/*#__PURE__*/_jsx(\"ul\",{children:addedRecords.map(function(record,index){return/*#__PURE__*/_jsx(\"li\",{children:record},index);})}):/*#__PURE__*/_jsx(\"p\",{children:\"No records added.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"failed-records\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Failed to Add Records:\"}),failedRecords.length>0?/*#__PURE__*/_jsx(\"ul\",{children:failedRecords.map(function(record,index){return/*#__PURE__*/_jsx(\"li\",{children:record},index);})}):/*#__PURE__*/_jsx(\"p\",{children:\"No records failed.\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rate-limit-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Google Calendar API Rate Limit Information:\"}),rateLimitInfo.limit!==null?/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"Limit: \",rateLimitInfo.limit]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Remaining: \",rateLimitInfo.remaining]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Reset Time: \",new Date(rateLimitInfo.reset*1000).toLocaleTimeString()]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No rate limit information available.\"})]}),/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return supabase.auth.signOut();},children:\"Sign Out\"})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return supabase.auth.signInWithOAuth({provider:'google',options:{scopes:'https://www.googleapis.com/auth/calendar'}});},children:\"Sign In With Google\"})})})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useSession","useSupabaseClient","useSessionContext","debounce","fn","delay","timeoutId","args","clearTimeout","setTimeout","createGoogleCalendarEvent","event","calendarId","session","signOut","setRateLimitInfo","console","log","provider_token","error","url","newEvent","summary","title","description","homeownerName","materialsNeeded","issuePictures","completedPictures","start","dateTime","toISOString","end","location","streetAddress","city","state","zipCode","fetch","method","headers","Authorization","body","JSON","stringify","response","json","data","remaining","get","limit","reset","ok","id","code","updateGoogleCalendarEvent","eventId","updatedEvent","updateAirtableWithGoogleEventId","airtableRecordId","googleEventId","updateData","fields","GoogleEventId","fetchAirtableEvents","retryCount","maxRetries","status","retryAfter","waitTime","parseInt","Math","pow","warn","Promise","resolve","Error","filteredRecords","records","filter","record","hasEventName","hasStartDate","hasEndDate","map","Date","branch","pic","join","length","checkForDuplicateEvent","items","existingEvent","find","sleep","ms","checkIfAirtableRecordExists","eventTitle","eventStart","eventEnd","populateGoogleCalendarWithAirtableRecords","calendarName","setAddedRecords","setFailedRecords","airtableEvents","added","failed","toLowerCase","existingAirtableRecord","push","existingGoogleEventId","updatedGoogleEventId","prev","CalendarSection","triggerSync","setTriggerSync","lastSyncTime","setLastSyncTime","syncEvents","now","then","catch","App","supabase","isLoading","addedRecords","failedRecords","rateLimitInfo","calendarInfo","name","sort","a","b","localeCompare","handleSyncNow","getGreeting","currentHour","getHours","width","margin","user","email","calendar","auth","index","toLocaleTimeString","signInWithOAuth","provider","options","scopes"],"sources":["/Users/richardmcgirt/Desktop/Warrenty2-/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport { useSession, useSupabaseClient, useSessionContext } from '@supabase/auth-helpers-react';\n\n// Helper to debounce API calls\nfunction debounce(fn, delay) {\n  let timeoutId;\n  return (...args) => {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n    timeoutId = setTimeout(() => {\n      fn(...args);\n    }, delay);\n  };\n}\n\nasync function createGoogleCalendarEvent(event, calendarId, session, signOut, setRateLimitInfo) {\n  console.log(`Attempting to create a new Google Calendar event for calendar: ${calendarId}`, event);\n\n  if (!session.provider_token) {\n    console.error('No valid session token available. Logging out.');\n    signOut();\n    return null;\n  }\n\n  const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events`;\n\n  const newEvent = {\n    summary: event.title,\n    description: `\n      ${event.description}\n      \\nHomeowner Name: ${event.homeownerName}\n      \\nMaterials Needed: ${event.materialsNeeded || 'Not specified'}\n      \\nIssue Pictures: ${event.issuePictures}\n      \\nCompleted Pictures: ${event.completedPictures}\n    `,\n    start: { dateTime: event.start.toISOString() },\n    end: { dateTime: event.end.toISOString() },\n    location: `${event.streetAddress}, ${event.city}, ${event.state}, ${event.zipCode}`,\n  };\n\n  console.log('Event data being sent to Google Calendar API:', newEvent);\n\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        Authorization: 'Bearer ' + session.provider_token,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(newEvent),\n    });\n\n    const data = await response.json();\n    console.log('Google Calendar API response:', data);\n\n    const remaining = response.headers.get('X-RateLimit-Remaining');\n    const limit = response.headers.get('X-RateLimit-Limit');\n    const reset = response.headers.get('X-RateLimit-Reset');\n    setRateLimitInfo({ remaining, limit, reset });\n\n    if (response.ok) {\n      console.log('Event successfully created in Google Calendar with ID:', data.id);\n      return data.id;\n    } else {\n      console.error('Failed to create event:', data);\n      if (data.error.code === 401) {\n        console.error('Unauthorized - Logging out');\n        signOut();\n      }\n      return null;\n    }\n  } catch (error) {\n    console.error('Error during Google Calendar API request:', error);\n    return null;\n  }\n}\n\nasync function updateGoogleCalendarEvent(event, calendarId, eventId, session, signOut, setRateLimitInfo) {\n  console.log(`Updating Google Calendar event for ID: ${eventId}`);\n\n  const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events/${eventId}`;\n\n  const updatedEvent = {\n    summary: event.title,\n    description: `\n      ${event.description}\n      \\nHomeowner Name: ${event.homeownerName}\n      \\nMaterials Needed: ${event.materialsNeeded || 'Not specified'}\n      \\nIssue Pictures: ${event.issuePictures}\n      \\nCompleted Pictures: ${event.completedPictures}\n    `,\n    start: { dateTime: event.start.toISOString() },\n    end: { dateTime: event.end.toISOString() },\n    location: `${event.streetAddress}, ${event.city}, ${event.state}, ${event.zipCode}`,\n  };\n\n  try {\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        Authorization: 'Bearer ' + session.provider_token,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updatedEvent),\n    });\n\n    const data = await response.json();\n    const remaining = response.headers.get('X-RateLimit-Remaining');\n    const limit = response.headers.get('X-RateLimit-Limit');\n    const reset = response.headers.get('X-RateLimit-Reset');\n    setRateLimitInfo({ remaining, limit, reset });\n\n    if (response.ok) {\n      console.log('Event successfully updated in Google Calendar with ID:', data.id);\n      return data.id;\n    } else {\n      console.error('Failed to update event:', data);\n      if (data.error.code === 401) {\n        signOut();\n      }\n      return null;\n    }\n  } catch (error) {\n    console.error('Error during Google Calendar API request:', error);\n    return null;\n  }\n}\n\nasync function updateAirtableWithGoogleEventId(airtableRecordId, googleEventId) {\n  console.log(`Updating Airtable record ${airtableRecordId} with Google Event ID: ${googleEventId}`);\n\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ/${airtableRecordId}`;\n  const updateData = {\n    fields: {\n      GoogleEventId: googleEventId,\n    },\n  };\n\n  try {\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(updateData),\n    });\n\n    const data = await response.json();\n    console.log('Airtable update response:', data);\n\n    if (data.error) {\n      console.error('Error updating Airtable with Google Event ID:', data.error);\n    } else {\n      console.log('Airtable record successfully updated with Google Event ID:', data);\n    }\n  } catch (error) {\n    console.error('Error during Airtable API request:', error);\n  }\n}\n\nasync function fetchAirtableEvents(retryCount = 0) {\n  console.log('Fetching events from Airtable...');\n\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ`;\n  const maxRetries = 1;\n\n  try {\n    const response = await fetch(url, {\n      headers: {\n        'Authorization': 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      if (response.status === 429) {\n        const retryAfter = response.headers.get('Retry-After');\n        const waitTime = retryAfter ? parseInt(retryAfter) * 1000 : Math.pow(2, retryCount) * 1000;\n\n        console.warn(`Rate limit hit. Retrying after ${waitTime}ms...`);\n\n        if (retryCount < maxRetries) {\n          await new Promise((resolve) => setTimeout(resolve, waitTime));\n          return fetchAirtableEvents(retryCount + 1); // Retry with incremented retry count\n        } else {\n          throw new Error('Max retries exceeded');\n        }\n      } else {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n    }\n\n    const data = await response.json();\n    console.log('Raw Airtable data fetched:', data);\n\n    const filteredRecords = data.records\n      .filter((record) => {\n        const hasEventName = !!record.fields['Calendar Event Name'];\n        const hasStartDate = !!record.fields['StartDate'];\n        const hasEndDate = !!record.fields['EndDate'];\n\n        if (!hasEventName || !hasStartDate || !hasEndDate) {\n          console.warn(`Record filtered out: ${record.id}`);\n          return false;\n        }\n\n        return true;\n      })\n      .map((record) => ({\n        id: record.id,\n        title: record.fields['Calendar Event Name'] || 'Untitled Event',\n        start: new Date(record.fields['StartDate']),\n        end: new Date(record.fields['EndDate']),\n        description: record.fields['Billable Reason (If Billable)'] || '',\n        branch: record.fields['b'] || 'Unknown',\n        homeownerName: record.fields['Homeowner Name'] || 'Unknown',\n        materialsNeeded: record.fields['Materials Needed'] || 'Not specified',\n        streetAddress: record.fields['Street Address'] || 'Unknown',\n        city: record.fields['City'] || 'Unknown',\n        state: record.fields['State'] || 'Unknown',\n        zipCode: record.fields['Zip Code'] || 'Unknown',\n        issuePictures: record.fields['Picture(s) of Issue'] ? record.fields['Picture(s) of Issue'].map(pic => pic.url).join(', ') : 'No pictures provided',\n        completedPictures: record.fields['Completed Pictures'] ? record.fields['Completed Pictures'].map(pic => pic.url).join(', ') : 'No pictures provided',\n        googleEventId: record.fields['GoogleEventId'] || null,\n      }));\n\n    console.log(`Airtable events to process: ${filteredRecords.length}`, filteredRecords);\n    return filteredRecords;\n\n  } catch (error) {\n    console.error('Error fetching events from Airtable:', error);\n    if (retryCount < maxRetries) {\n      console.log(`Retrying fetch attempt ${retryCount + 1} of ${maxRetries}...`);\n      return fetchAirtableEvents(retryCount + 1);\n    } else {\n      throw error; // Re-throw the error after max retries\n    }\n  }\n}\n\nasync function checkForDuplicateEvent(event, calendarId, session) {\n  const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?timeMin=${event.start.toISOString()}&timeMax=${event.end.toISOString()}`;\n\n  try {\n    const response = await fetch(url, {\n      headers: {\n        Authorization: 'Bearer ' + session.provider_token,\n      },\n    });\n\n    const data = await response.json();\n    if (data.items) {\n      const existingEvent = data.items.find(\n        (existingEvent) =>\n          existingEvent.summary === event.title &&\n          existingEvent.location === `${event.streetAddress}, ${event.city}, ${event.state}, ${event.zipCode}`\n      );\n\n      return existingEvent ? existingEvent.id : null; // Return the Google Event ID if a match is found\n    }\n  } catch (error) {\n    console.error('Error checking for duplicate events in Google Calendar:', error);\n    return null;\n  }\n}\n\nfunction sleep(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nasync function checkIfAirtableRecordExists(eventTitle, eventStart, eventEnd) {\n  const url = `https://api.airtable.com/v0/appO21PVRA4Qa087I/tbl6EeKPsNuEvt5yJ?filterByFormula=AND({Calendar Event Name}=\"${eventTitle}\", {StartDate}=\"${eventStart.toISOString()}\", {EndDate}=\"${eventEnd.toISOString()}\")`;\n\n  try {\n    const response = await fetch(url, {\n      headers: {\n        Authorization: 'Bearer patXTUS9m8os14OO1.6a81b7bc4dd88871072fe71f28b568070cc79035bc988de3d4228d52239c8238',\n        'Content-Type': 'application/json',\n      },\n    });\n\n    const data = await response.json();\n    return data.records.length > 0 ? data.records[0] : null;\n  } catch (error) {\n    console.error('Error checking Airtable for existing record:', error);\n    return null;\n  }\n}\n\nasync function populateGoogleCalendarWithAirtableRecords(\n  calendarId,\n  calendarName,\n  session,\n  signOut,\n  setAddedRecords,\n  setFailedRecords,\n  setRateLimitInfo\n) {\n  console.log(`Starting to populate Google Calendar \"${calendarName}\" with Airtable records...`);\n\n  const airtableEvents = await fetchAirtableEvents();\n  console.log(`Processing ${airtableEvents.length} Airtable events for Google Calendar sync...`);\n\n  const added = [];\n  const failed = [];\n\n  for (const event of airtableEvents) {\n    console.log(`Processing event \"${event.title}\"...`);\n\n    if (event.branch.toLowerCase() === 'unknown' || event.branch.toLowerCase() !== calendarName.toLowerCase()) {\n      console.log(\n        `Skipping event \"${event.title}\" due to branch \"${event.branch}\" not matching \"${calendarName}\" or being \"Unknown\"`\n      );\n      continue;\n    }\n\n    // Check if this event already exists in Airtable before creating a duplicate\n    const existingAirtableRecord = await checkIfAirtableRecordExists(event.title, event.start, event.end);\n\n    if (existingAirtableRecord) {\n      console.log(`Event \"${event.title}\" already exists in Airtable. Skipping creation.`);\n      failed.push(event.title);\n      continue;\n    }\n\n    const existingGoogleEventId = await checkForDuplicateEvent(event, calendarId, session);\n    if (existingGoogleEventId) {\n      console.log(`Duplicate event found: \"${event.title}\". Updating...`);\n\n      const updatedGoogleEventId = await updateGoogleCalendarEvent(\n        event,\n        calendarId,\n        existingGoogleEventId,\n        session,\n        signOut,\n        setRateLimitInfo\n      );\n\n      if (updatedGoogleEventId) {\n        await updateAirtableWithGoogleEventId(event.id, updatedGoogleEventId);\n        added.push(event.title);\n      } else {\n        failed.push(event.title);\n      }\n\n    } else {\n      const googleEventId = await createGoogleCalendarEvent(\n        event,\n        calendarId,\n        session,\n        signOut,\n        setRateLimitInfo\n      );\n\n      if (googleEventId) {\n        await updateAirtableWithGoogleEventId(event.id, googleEventId);\n        added.push(event.title);\n      } else {\n        failed.push(event.title);\n      }\n    }\n\n    await sleep(1000); // Adding delay between requests\n  }\n\n  setAddedRecords((prev) => [...prev, ...added]);\n  setFailedRecords((prev) => [...prev, ...failed]);\n\n  console.log(`Finished populating Google Calendar \"${calendarName}\" with Airtable records.`);\n}\n\nfunction CalendarSection({\n  calendarId,\n  calendarName,\n  session,\n  signOut,\n  setAddedRecords,\n  setFailedRecords,\n  setRateLimitInfo,\n  triggerSync,\n  setTriggerSync\n}) {\n  const [lastSyncTime, setLastSyncTime] = useState(null);\n\n  useEffect(() => {\n    const syncEvents = () => {\n      const now = new Date();\n      console.log('Attempting to sync events...');\n\n      if (lastSyncTime && now - lastSyncTime < 900000) {\n        console.log('Sync skipped. Last sync was less than 15 minutes ago.');\n        return;\n      }\n\n      if (session && triggerSync) {\n        if (!session.provider_token) {\n          console.error('No valid session token found. Logging out.');\n          signOut();\n          return;\n        }\n\n        console.log('Session valid. Initiating sync...');\n        populateGoogleCalendarWithAirtableRecords(\n          calendarId,\n          calendarName,\n          session,\n          signOut,\n          setAddedRecords,\n          setFailedRecords,\n          setRateLimitInfo\n        )\n          .then(() => {\n            console.log(`Finished syncing events to Google Calendar \"${calendarName}\"`);\n            setLastSyncTime(new Date()); // Update last sync time\n            setTriggerSync(false); // Reset the triggerSync after sync\n          })\n          .catch((error) =>\n            console.error(`Error syncing Airtable to Google Calendar \"${calendarName}\":`, error)\n          );\n      }\n    };\n\n    if (triggerSync) {\n      console.log(`Manual sync triggered for calendar: ${calendarName}`);\n      syncEvents();\n    }\n  }, [session, signOut, calendarId, calendarName, setAddedRecords, setFailedRecords, setRateLimitInfo, lastSyncTime, triggerSync, setTriggerSync]);\n\n  return (\n    <div className=\"calendar-item\">\n      <h2>{calendarName}</h2>\n    </div>\n  );\n}\n\nfunction App() {\n  const session = useSession();\n  const supabase = useSupabaseClient();\n  const { isLoading } = useSessionContext();\n\n  const [addedRecords, setAddedRecords] = useState([]);\n  const [failedRecords, setFailedRecords] = useState([]);\n  const [rateLimitInfo, setRateLimitInfo] = useState({ remaining: null, limit: null, reset: null });\n  const [triggerSync, setTriggerSync] = useState(false);\n\n  const calendarInfo = [\n    { id: 'c_ebe1fcbce1be361c641591a6c389d4311df7a97961af0020c889686ae059d20a@group.calendar.google.com', name: 'Savannah' }\n  ].sort((a, b) => a.name.localeCompare(b.name));\n\n  const handleSyncNow = () => {\n    console.log('Manual sync button clicked.');\n    setTriggerSync(true); // Trigger manual sync\n  };\n\n  const getGreeting = () => {\n    const currentHour = new Date().getHours();\n    if (currentHour < 12) {\n      return 'Good morning';\n    } else if (currentHour < 18) {\n      return 'Good afternoon';\n    } else {\n      return 'Good evening';\n    }\n  };\n\n  if (isLoading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"container\">\n        <h1>Warranty Calendar</h1>\n        <div style={{ width: '100%', margin: '0 auto' }}>\n          {session ? (\n            <>\n              <h2>{getGreeting()} {session.user.email}</h2>\n              <hr />\n              <button onClick={handleSyncNow}>Sync Now</button> {/* Manual Sync Button */}\n              <div className=\"calendar-grid\">\n                {calendarInfo.map((calendar) => (\n                  <CalendarSection\n                    key={calendar.id}\n                    calendarId={calendar.id}\n                    calendarName={calendar.name}\n                    session={session}\n                    signOut={() => supabase.auth.signOut()}\n                    setAddedRecords={setAddedRecords}\n                    setFailedRecords={setFailedRecords}\n                    setRateLimitInfo={setRateLimitInfo}\n                    triggerSync={triggerSync}\n                    setTriggerSync={setTriggerSync}\n                  />\n                ))}\n              </div>\n              <div className=\"records-summary\">\n                <h3>Records Summary</h3>\n                <div className=\"summary-container\">\n                  <div className=\"added-records\">\n                    <h4>Successfully Added Records:</h4>\n                    {addedRecords.length > 0 ? (\n                      <ul>\n                        {addedRecords.map((record, index) => (\n                          <li key={index}>{record}</li>\n                        ))}\n                      </ul>\n                    ) : (\n                      <p>No records added.</p>\n                    )}\n                  </div>\n                  <div className=\"failed-records\">\n                    <h4>Failed to Add Records:</h4>\n                    {failedRecords.length > 0 ? (\n                      <ul>\n                        {failedRecords.map((record, index) => (\n                          <li key={index}>{record}</li>\n                        ))}\n                      </ul>\n                    ) : (\n                      <p>No records failed.</p>\n                    )}\n                  </div>\n                </div>\n              </div>\n              <div className=\"rate-limit-info\">\n                <h4>Google Calendar API Rate Limit Information:</h4>\n                {rateLimitInfo.limit !== null ? (\n                  <ul>\n                    <li>Limit: {rateLimitInfo.limit}</li>\n                    <li>Remaining: {rateLimitInfo.remaining}</li>\n                    <li>Reset Time: {new Date(rateLimitInfo.reset * 1000).toLocaleTimeString()}</li>\n                  </ul>\n                ) : (\n                  <p>No rate limit information available.</p>\n                )}\n              </div>\n              <p></p>\n              <button onClick={() => supabase.auth.signOut()}>Sign Out</button>\n            </>\n          ) : (\n            <>\n              <button onClick={() => supabase.auth.signInWithOAuth({ provider: 'google', options: { scopes: 'https://www.googleapis.com/auth/calendar' } })}>\n                Sign In With Google\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}